<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Metrics &mdash; Finagle 6.28.0 documentation</title>
    
    <link rel="stylesheet" href="_static/finagle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '6.28.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Finagle 6.28.0 documentation" href="index.html" />
    <link rel="next" title="FAQ" href="FAQ.html" />
    <link rel="prev" title="Extending Finagle" href="Extending.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="_static/small_flask.css" type= "text/css" rel="stylesheet" />
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-39101739-4', 'twitter.github.io');
    ga('send', 'pageview');

  </script>

  </head>
  <body>
  
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="FAQ.html" title="FAQ"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Extending.html" title="Extending Finagle"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Finagle</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="metrics">
<h1>Metrics<a class="headerlink" href="#metrics" title="Permalink to this headline">¶</a></h1>
<p>This section aims to be a comprehensive list of all of the stats that finagle
exposes.  The stats are organized by layer and then by class.</p>
<p>Some of the stats are only for clients, some only for servers, and some are for both.
Some stats are only visible when certain optional classes are used.</p>
<p>NB: Finagle uses RollupStatsReceiver internally, which will take stats like
&#8220;failures/twitter/TimeoutException&#8221; and roll them up, aggregating into &#8220;failures/twitter&#8221;
and also &#8220;failures&#8221;.  For example, if there are 3 &#8220;failures/twitter/TimeoutException&#8221; counted,
and 4 &#8220;failures/twitter/ConnectTimeoutException&#8221;, then it will cound 7 &#8220;failures/twitter&#8221;.</p>
<div class="section" id="public">
<h2>Public<a class="headerlink" href="#public" title="Permalink to this headline">¶</a></h2>
<p id="public-stats">These stats come from the public interface, and are the ones that you should look at first
to figure out whether a client is abusing you, or you are misusing a downstream service.
They are also useful in diagnosing what contributes to request latency.</p>
<div class="section" id="statsfilter">
<h3>StatsFilter<a class="headerlink" href="#statsfilter" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>requests</strong></dt>
<dd>a counter of the total number of successes + failures</dd>
<dt><strong>success</strong></dt>
<dd>a counter of the total number of successes</dd>
<dt><strong>request_latency_ms</strong></dt>
<dd>a histogram of the latency of requests in milliseconds</dd>
<dt><strong>load</strong></dt>
<dd>a gauge of the current total number of outstanding requests</dd>
<dt><strong>pending</strong></dt>
<dd>a gauge of the current total number of outstanding requests</dd>
<dt><strong>failures/&lt;exception_name&gt;+</strong></dt>
<dd>a counter of the number of times a specific exception has been thrown</dd>
<dt><strong>failures</strong></dt>
<dd>a counter of the number of times any exception has been thrown</dd>
<dt><strong>sourcedfailures/&lt;source_service_name&gt;{/&lt;exception_name&gt;}+</strong></dt>
<dd>a counter of the number of times a specific SourcedException or sourced
Failure has been thrown</dd>
<dt><strong>sourcedfailures/&lt;source_service_name&gt;</strong></dt>
<dd>a counter of the number of times any SourcedException or sourced Failure has
been thrown from this service</dd>
<dt><strong>sourcedfailures</strong></dt>
<dd>a counter of the number of times any SourcedException or sourced Failure has
been thrown</dd>
<dt><strong>transit_latency_ms</strong></dt>
<dd>a stat that attempts to measure (walltime) transit times between hops, e.g.,
from client to server. Not supported by all protocols.</dd>
<dt><strong>deadline_budget_ms</strong></dt>
<dd>a stat accounting for the (implied) amount of time remaining for this request,
for example from a deadline or timeout. Not supported by all protocols.</dd>
</dl>
</div>
<div class="section" id="statsfactorywrapper">
<h3>StatsFactoryWrapper<a class="headerlink" href="#statsfactorywrapper" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>failures/&lt;exception_class_name&gt;</strong></dt>
<dd>a counter of the number of times a service factory has failed with this
specific exception</dd>
<dt><strong>failures</strong></dt>
<dd>a counter of the number of times a service factory has failed</dd>
<dt><strong>service_acquisition_latency_ms</strong></dt>
<dd>a stat of the latency to acquire a service in milliseconds
this entails establishing a connection or waiting for a connection from a pool</dd>
</dl>
</div>
<div class="section" id="handletimefilter">
<h3>HandletimeFilter<a class="headerlink" href="#handletimefilter" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>handletime_us</strong></dt>
<dd>a histogram of the time it takes to handle the request in microseconds
NB: does not include the time to respond</dd>
</dl>
</div>
<div class="section" id="defaultserver">
<h3>DefaultServer<a class="headerlink" href="#defaultserver" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>request_concurrency</strong></dt>
<dd>a gauge of the total number of current concurrent requests</dd>
<dt><strong>request_queue_size</strong></dt>
<dd>a gauge of the total number of requests which are waiting because of the limit
on simultaneous requests</dd>
</dl>
</div>
</div>
<div class="section" id="construction">
<h2>Construction<a class="headerlink" href="#construction" title="Permalink to this headline">¶</a></h2>
<p id="construction-stats">These stats are about setting up services in finagle, and expose whether you are
having trouble making services.</p>
<div class="section" id="clientbuilder">
<h3>ClientBuilder<a class="headerlink" href="#clientbuilder" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>codec_connection_preparation_latency_ms</strong></dt>
<dd>a histogram of the length of time it takes to prepare a connection and get back a service,
regardless of success or failure</dd>
</dl>
</div>
<div class="section" id="statsservicefactory">
<h3>StatsServiceFactory<a class="headerlink" href="#statsservicefactory" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>available</strong></dt>
<dd>a gauge of whether the underlying factory is available (1) or not (0).  finagle uses this
primarily to decide whether a host is available to make new connections to in the load balancer.</dd>
</dl>
</div>
</div>
<div class="section" id="service-discovery">
<h2>Service Discovery<a class="headerlink" href="#service-discovery" title="Permalink to this headline">¶</a></h2>
<p id="id1">These metrics track the state of name resolution and service discovery.</p>
<div class="section" id="name-resolution">
<h3>Name Resolution<a class="headerlink" href="#name-resolution" title="Permalink to this headline">¶</a></h3>
<p>Finagle clients resolve <a class="reference internal" href="Names.html"><em>names</em></a> into sets of network
addresses to which sockets can be opened. A number of the moving parts
involved in this process are cached (i.e. <cite>Dtab</cite>s, <cite>Name</cite>s, and
<cite>NameTree</cite>s). The following stats are recorded under the
<cite>namer/{dtabcache,namecache,nametreecache}</cite> scopes to provide
visibility into this caching.</p>
<dl class="docutils">
<dt><strong>misses</strong></dt>
<dd>A counter of the number of cache misses</dd>
<dt><strong>evicts</strong></dt>
<dd>A counter of the number of cache evictions</dd>
<dt><strong>idle</strong></dt>
<dd>A gauge of the number of cached idle <cite>ServiceFactory</cite>s</dd>
<dt><strong>oneshots</strong></dt>
<dd>A counter of the number of &#8220;one-off&#8221; <cite>ServiceFactory</cite>s that are
created in the event that no idle <cite>ServiceFactory</cite>s are cached</dd>
</dl>
<p>The total time spent resolving Names is captured in the
<cite>namer/bind_latency_us</cite> stat.</p>
</div>
<div class="section" id="initial-resolution">
<h3>Initial Resolution<a class="headerlink" href="#initial-resolution" title="Permalink to this headline">¶</a></h3>
<p><strong>initialresolution_ms</strong></p>
<blockquote>
<div>A counter of the time spent waiting for client resolution via
<cite>com.twitter.finagle.client.ClientRegistry.expAllRegisteredClientsResolved</cite></div></blockquote>
</div>
<div class="section" id="address-stabilization">
<h3>Address Stabilization<a class="headerlink" href="#address-stabilization" title="Permalink to this headline">¶</a></h3>
<p>Resolved addresses (represented as an instance of
<cite>com.twitter.finagle.Addr</cite>) are stabilized in two ways:</p>
<ol class="arabic simple">
<li>ZooKeeper failures will not cause a previously bound address to fail.</li>
<li>When a member leaves a cluster, its removal is delayed.</li>
</ol>
<p>Note that hosts added to a cluster are reflected immediately.</p>
<p>The following metrics are scoped under the concatenation of <cite>zk2/</cite> and
the ServerSet&#8217;s ZooKeeper path.</p>
<dl class="docutils">
<dt><strong>limbo</strong></dt>
<dd>A gauge tracking the number of endpoints that are in &#8220;limbo&#8221;. When a
member leaves a cluster, it is placed in limbo. Hosts in limbo are
still presented to the load balancer as belonging to the cluster,
but are staged for removal. They are removed if they do not recover
within an interval bound by the ZooKeeper session timeout.</dd>
<dt><strong>size</strong></dt>
<dd>A gauge tracking the total size of the live cluster, not including
members in limbo.</dd>
<dt><strong>observed_serversets</strong></dt>
<dd>A gauge tracking the number of clusters whose membership status is
<em>currently</em> been tracked within the process. This metric differs from
<cite>session_cache_size</cite> below in that it tracks live clusters rather
than the total number of cached sessions.</dd>
</dl>
</div>
<div class="section" id="zookeeper-diagnostics">
<h3>ZooKeeper Diagnostics<a class="headerlink" href="#zookeeper-diagnostics" title="Permalink to this headline">¶</a></h3>
<p>The following stats reflect diagnostic information about the ZooKeeper
sessions opened for the purposes of service discovery.</p>
<div class="section" id="under-the-zk2-scope">
<h4>Under the `zk2` scope<a class="headerlink" href="#under-the-zk2-scope" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><strong>session_cache_size</strong></dt>
<dd>A gauge tracking the number of distinct logical clusters whose
membership status has been tracked within the process.</dd>
<dt><strong>entries/read_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of reading entry znodes</dd>
<dt><strong>entries/parse_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of parsing the data
within entry znodes</dd>
<dt><strong>vectors/read_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of reading vector znodes</dd>
<dt><strong>vectors/parse_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of parsing the data
within vector znodes</dd>
</dl>
</div>
<div class="section" id="under-the-zkclient-scope">
<h4>Under the `zkclient` scope<a class="headerlink" href="#under-the-zkclient-scope" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><strong>ephemeral_successes</strong></dt>
<dd>A counter of the number successful ephemeral node creations</dd>
<dt><strong>ephemeral_failures</strong></dt>
<dd>A counter of the number failed ephemeral node creations</dd>
<dt><strong>ephemeral_latency_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of ephemeral node creation</dd>
<dt><strong>watch_successes</strong></dt>
<dd>A counter of the number successful watch-related operations
(i.e. &#8220;watch exists&#8221;, &#8220;get watch data&#8221;, and &#8220;get child watches&#8221;
operations)</dd>
<dt><strong>watch_failures</strong></dt>
<dd>A counter of the number failed watch-related operations</dd>
<dt><strong>watch_latency_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of watch-related operations</dd>
<dt><strong>read_successes</strong></dt>
<dd>A counter of the number successful ZooKeeper reads</dd>
<dt><strong>read_failures</strong></dt>
<dd>A counter of the number failed ZooKeeper reads</dd>
<dt><strong>read_latency_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of ZooKeeper reads</dd>
<dt><strong>write_successes</strong></dt>
<dd>A counter of the number successful ZooKeeper writes</dd>
<dt><strong>write_failures</strong></dt>
<dd>A counter of the number failed ZooKeeper writes</dd>
<dt><strong>write_latency_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of ZooKeeper writes</dd>
<dt><strong>multi_successes</strong></dt>
<dd>A counter of the number successful transactional operations</dd>
<dt><strong>multi_failures</strong></dt>
<dd>A counter of the number failed transactional operations</dd>
<dt><strong>multi_latency_ms</strong></dt>
<dd>A histogram of the latency, in milliseconds, of transactional operations</dd>
<dt><strong>session_sync_connected</strong></dt>
<dd>A counter of the number of read-write session transitions</dd>
<dt><strong>session_connected_read_only</strong></dt>
<dd>A counter of the number of read-only session transitions</dd>
<dt><strong>session_no_sync_connected</strong></dt>
<dd>Unused (should always be 0)</dd>
<dt><strong>session_sasl_authenticated</strong></dt>
<dd>A counter of the number of sessions upgraded to SASL</dd>
<dt><strong>session_auth_failed</strong></dt>
<dd>A counter of the number of session authentication failures</dd>
<dt><strong>session_disconnected</strong></dt>
<dd>A counter of the number of temporary session disconnects</dd>
<dt><strong>session_expired</strong></dt>
<dd>A counter of the number of session expirations</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="load-balancing">
<h2>Load Balancing<a class="headerlink" href="#load-balancing" title="Permalink to this headline">¶</a></h2>
<p id="loadbalancer-stats">The client stats under the <cite>loadbalancer</cite> scope expose the innards of
what&#8217;s going on with load balancing, and the management of equivalent
groups of hosts.</p>
<div class="section" id="all-balancers">
<h3>All Balancers<a class="headerlink" href="#all-balancers" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>size</strong></dt>
<dd>A gauge of the number of nodes being balanced across</dd>
<dt><strong>available</strong></dt>
<dd>A gauge of the number of <em>available</em> nodes as seen by the load balancer.
These nodes are ready to receive traffic.</dd>
<dt><strong>busy</strong></dt>
<dd>A gauge of the number of <em>busy</em> nodes as seen by the load balancer.
These nodes are current unavailable for service.</dd>
<dt><strong>closed</strong></dt>
<dd>A gauge of the number of <em>closed</em> nodes as seen by the load balancer.
These nodes will never be available for service.</dd>
<dt><strong>load</strong></dt>
<dd>A gauge of the total load over all nodes being balanced across</dd>
<dt><strong>meanweight</strong></dt>
<dd>A gauge tracking the arithmetic mean of the weights of the endpoints
being load-balanced across. Does not apply to
<cite>com.twitter.finagle.loadbalancer.HeapBalancer</cite>.</dd>
<dt><strong>adds</strong></dt>
<dd>A counter of the number of hosts added to the loadbalancer</dd>
<dt><strong>removes</strong></dt>
<dd>A counter of the number of hosts removed from the loadbalancer</dd>
</dl>
</div>
<div class="section" id="apertureloadbandbalancer">
<h3>ApertureLoadBandBalancer<a class="headerlink" href="#apertureloadbandbalancer" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>aperture</strong></dt>
<dd>A gauge of the width of the window over which endpoints are
load-balanced</dd>
</dl>
</div>
</div>
<div class="section" id="fail-fast">
<h2>Fail Fast<a class="headerlink" href="#fail-fast" title="Permalink to this headline">¶</a></h2>
<p id="fail-fast-stats">The client stats under the <cite>failfast</cite> scope give insight into how
finagle handles services where it can&#8217;t make a connection.</p>
<div class="section" id="failfastfactory">
<h3>FailFastFactory<a class="headerlink" href="#failfastfactory" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>marked_dead</strong></dt>
<dd>a counter of how many times the <cite>FailFastFactory</cite> has been marked dead</dd>
<dt><strong>unhealthy_for_ms</strong></dt>
<dd>a gauge of how long the <cite>FailFastFactory</cite> has been retrying for this failure</dd>
<dt><strong>unhealthy_num_tries</strong></dt>
<dd>a gauge of the number of times the <cite>FailFastFactory</cite> has retried for this failure</dd>
</dl>
</div>
</div>
<div class="section" id="failure-accrual">
<h2>Failure Accrual<a class="headerlink" href="#failure-accrual" title="Permalink to this headline">¶</a></h2>
<p id="failure-accrual-stats">The client stats under the <cite>failure_accrual</cite> scope track how <cite>FailureAccrualFactory</cite>
manages failures.</p>
</div>
<div class="section" id="idle-apoptosis">
<h2>Idle Apoptosis<a class="headerlink" href="#idle-apoptosis" title="Permalink to this headline">¶</a></h2>
<p id="idle-apoptosis-stats">These client stats keep track of how frequently
<a class="reference internal" href="ServicesAndFilters.html"><em>Services</em></a> are closed due to prolonged idleness.</p>
<div class="section" id="expiringservice">
<h3>ExpiringService<a class="headerlink" href="#expiringservice" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>idle</strong></dt>
<dd>a counter of the number of times the service has expired from staying idle for too long
in between requests</dd>
<dt><strong>lifetime</strong></dt>
<dd>a counter of the number of times the service has exceeded its lifetime expiration duration</dd>
</dl>
</div>
</div>
<div class="section" id="rate-limiting">
<h2>Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permalink to this headline">¶</a></h2>
<p id="rate-limiting-stats">These client stats show how much you&#8217;re hitting your rate limit if you&#8217;re using rate limiting.</p>
<div class="section" id="ratelimitingfilter">
<h3>RateLimitingFilter<a class="headerlink" href="#ratelimitingfilter" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>refused</strong></dt>
<dd>a counter of the number of refused connections by the rate limiting filter</dd>
</dl>
</div>
<div class="section" id="requeue">
<h3>Requeue<a class="headerlink" href="#requeue" title="Permalink to this headline">¶</a></h3>
<p>There is a &#8220;requeues&#8221; stat that&#8217;s scoped to &#8220;requeue&#8221;, which tracks
requests that fail (or failures to establish a session) but have been
automatically re-enqueued when finagle detects that it&#8217;s safe.
These re-enqueues are credited by finagle and they don&#8217;t sap your
retry budget.</p>
<dl class="docutils">
<dt><strong>requeues</strong></dt>
<dd>a counter of the number of times the service had to retry</dd>
<dt><strong>budget</strong></dt>
<dd>a gauge representing the instantaneous requeue budget</dd>
</dl>
</div>
</div>
<div class="section" id="pooling">
<h2>Pooling<a class="headerlink" href="#pooling" title="Permalink to this headline">¶</a></h2>
<p id="pool-stats">These client stats help you keep track of connection churn.</p>
<div class="section" id="cachingpool">
<h3>CachingPool<a class="headerlink" href="#cachingpool" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>pool_cached</strong></dt>
<dd>a gauge of the number of connections cached in the idle Cache</dd>
</dl>
</div>
<div class="section" id="watermarkpool">
<h3>WatermarkPool<a class="headerlink" href="#watermarkpool" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>pool_waiters</strong></dt>
<dd>a gauge of the number of clients waiting on connections</dd>
<dt><strong>pool_size</strong></dt>
<dd>a gauge of the number of connections that are currently alive, either in use or not</dd>
<dt><strong>pool_num_waited</strong></dt>
<dd>a counter of the number of times there were no connections immediately available and the client waited for a connection</dd>
<dt><strong>pool_num_too_many_waiters</strong></dt>
<dd>a counter of the number of times there were no connections immediately available and there were already too many waiters</dd>
</dl>
</div>
<div class="section" id="singletonpool">
<h3>SingletonPool<a class="headerlink" href="#singletonpool" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>conn/fail</strong></dt>
<dd>a counter of the number of times the connection could not be established and must be retried</dd>
<dt><strong>conn/dead</strong></dt>
<dd>a counter of the number of times the connection succeeded once, but later died and must be retried</dd>
</dl>
</div>
</div>
<div class="section" id="transport">
<h2>Transport<a class="headerlink" href="#transport" title="Permalink to this headline">¶</a></h2>
<p id="transport-stats">These metrics pertain to where the finagle abstraction ends and the bytes are sent over the wire.
Understanding these stats often requires deep knowledge of the protocol, or individual transport
(e.g. Netty) internals.</p>
<div class="section" id="channelconnector">
<h3>ChannelConnector<a class="headerlink" href="#channelconnector" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>connect_latency_ms</strong></dt>
<dd>a histogram of the length of time it takes for a connection to succeed, in milliseconds</dd>
<dt><strong>failed_connect_latency_ms</strong></dt>
<dd>a histogram of the length of time it takes for a connection to fail, in milliseconds</dd>
<dt><strong>cancelled_connects</strong></dt>
<dd>a counter of the number of attempts to connect that were cancelled before they succeeded</dd>
</dl>
</div>
<div class="section" id="serverbridge">
<h3>ServerBridge<a class="headerlink" href="#serverbridge" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>read_timeout</strong></dt>
<dd>a counter of the number of times the netty channel has caught a ReadTimeoutException.
this should be the number of timeouts when reading</dd>
<dt><strong>write_timeout</strong></dt>
<dd>a counter of the number of times the netty channel has caught a WriteTimeoutException.
this should be the number of timeouts when writing</dd>
</dl>
</div>
<div class="section" id="channelrequeststatshandler">
<h3>ChannelRequestStatsHandler<a class="headerlink" href="#channelrequeststatshandler" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>connection_requests</strong></dt>
<dd>a histogram of the number of requests received over the lifetime of a connection</dd>
</dl>
</div>
<div class="section" id="channelstatshandler">
<h3>ChannelStatsHandler<a class="headerlink" href="#channelstatshandler" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>connects</strong></dt>
<dd>a counter of the total number of successful connections made</dd>
<dt><strong>connection_duration</strong></dt>
<dd>a histogram of the duration of the lifetime of a connection</dd>
<dt><strong>connection_received_bytes</strong></dt>
<dd>a histogram of the number of bytes received over the lifetime of a connection</dd>
<dt><strong>connection_sent_bytes</strong></dt>
<dd>a histogram of the number of bytes sent over the lifetime of a connection</dd>
<dt><strong>received_bytes</strong></dt>
<dd>a counter of the total number of received bytes</dd>
<dt><strong>sent_bytes</strong></dt>
<dd>a counter of the total number of sent bytes</dd>
<dt><strong>closechans</strong></dt>
<dd>a counter of the total number of connections closed</dd>
<dt><strong>writableDuration</strong></dt>
<dd>a gauge of the length of time the socket has been writable in the channel</dd>
<dt><strong>unwritableDuration</strong></dt>
<dd>a gauge of the length of time the socket has been unwritable in the channel</dd>
<dt><strong>connections</strong></dt>
<dd>a gauge of the total number of connections that are currently open in the channel</dd>
<dt><strong>exn/&lt;exception_name&gt;+</strong></dt>
<dd>a counter of the number of times a specific exception has been thrown within a Netty pipeline</dd>
</dl>
</div>
<div class="section" id="idlechannelhandler">
<h3>IdleChannelHandler<a class="headerlink" href="#idlechannelhandler" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>disconnects/{READER_IDLE,WRITER_IDLE}</strong></dt>
<dd>a counter of the number of times a connection was disconnected because of a given idle state</dd>
</dl>
</div>
<div class="section" id="idleconnectionfilter">
<h3>IdleConnectionFilter<a class="headerlink" href="#idleconnectionfilter" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>refused</strong></dt>
<dd>a counter of the number of connections that have been refused because we have hit the high
watermark of connections full and no connections are idle.</dd>
<dt><strong>idle</strong></dt>
<dd>a gauge of the number of connections that are &#8220;idle&#8221; at this moment</dd>
<dt><strong>closed</strong></dt>
<dd>a counter of the number of connections that have been closed for being idle</dd>
</dl>
</div>
<div class="section" id="thrift">
<h3>Thrift<a class="headerlink" href="#thrift" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>srv/thrift/buffer/resetCount</strong></dt>
<dd>a counter for the number of times the thrift server re-initialized the buffer for thrift responses. The thrift server maintains a growable reusable buffer for responses. Once the buffer reaches the threshold size it is discarded and reset to a smaller size. This is done to accommodate variable response sizes. A high resetCount means the server is allocating and releasing memory frequently. Use the <cite>com.twitter.finagle.Thrift.param.MaxReusableBufferSize</cite> to set the max buffer size to the size of  a typical thrift response for your server.</dd>
</dl>
</div>
</div>
<div class="section" id="requeues">
<h2>Requeues<a class="headerlink" href="#requeues" title="Permalink to this headline">¶</a></h2>
<p id="id2">These metrics show requeues (automatic retries) by the Finagle Stack. The number of retries are
controlled by a dynamic budget.</p>
<dl class="docutils">
<dt><strong>requeue/requeues</strong></dt>
<dd>a counter of the number of times requests are requeued</dd>
<dt><strong>requeue/budget</strong></dt>
<dd>a gauge of the current available retry budget</dd>
<dt><strong>requeue/budget_exhausted</strong></dt>
<dd>a counter of the number of times when the budget is exhausted</dd>
</dl>
</div>
<div class="section" id="mux">
<h2>Mux<a class="headerlink" href="#mux" title="Permalink to this headline">¶</a></h2>
<p id="mux-stats">These stats pertain to <a class="reference internal" href="Protocols.html#mux"><em>Mux</em></a>.</p>
<dl class="docutils">
<dt><strong>&lt;server_label&gt;/mux/draining</strong></dt>
<dd>the number of times the server has initiated session draining</dd>
<dt><strong>&lt;server_label&gt;/mux/drained</strong></dt>
<dd>the number of times the server has successfully completed the draining protocol within its allotted time</dd>
<dt><strong>&lt;client_label&gt;/mux/draining</strong></dt>
<dd>the number of times a server initiated session draining</dd>
<dt><strong>&lt;client_label&gt;/mux/drained</strong></dt>
<dd>the number of times server-initiated draining completed successfully</dd>
<dt><strong>clienthangup</strong></dt>
<dd>the number of times sessions have been abruptly terminated by the client</dd>
<dt><strong>serverhangup</strong></dt>
<dd>the number of times sessions have been abruptly terminated by the server</dd>
</dl>
</div>
<div class="section" id="threshold-failure-detector">
<h2>Threshold Failure Detector<a class="headerlink" href="#threshold-failure-detector" title="Permalink to this headline">¶</a></h2>
<p id="failure-detector">The client metrics under the <cite>mux/failuredetector</cite> scope track the behavior of out-of-band ping
based failure detection. They only apply to the mux protocol.</p>
<div class="section" id="thresholdfailuredetector">
<h3>ThresholdFailureDetector<a class="headerlink" href="#thresholdfailuredetector" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><strong>ping</strong></dt>
<dd>a counter of the number of pings sent to remote peers</dd>
<dt><strong>ping_latency_us</strong></dt>
<dd>a stat of round trip ping latencies in microseconds</dd>
<dt><strong>marked_busy</strong></dt>
<dd>a counter of the number of times the endpoints are marked busy</dd>
<dt><strong>revivals</strong></dt>
<dd>a counter of the number of times the endpoints revive</dd>
<dt><strong>close</strong></dt>
<dd>a counter of the number of endpoints that are closed</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="index.html">
  <img class="logo" src="_static/logo_small.png" alt="Logo"/>
</a></p><a href="index.html"><h3>Finagle</h3></a>
<p>
  Finagle is a network stack for distributed systems.
</p>

<h3>Useful Links</h3>
<ul>
  <li><a href="http://github.com/twitter/finagle">Finagle @ GitHub</a></li>
  <li><a href="http://github.com/twitter/finagle/issues">Issue Tracker</a></li>
</ul>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Metrics</a><ul>
<li><a class="reference internal" href="#public">Public</a><ul>
<li><a class="reference internal" href="#statsfilter">StatsFilter</a></li>
<li><a class="reference internal" href="#statsfactorywrapper">StatsFactoryWrapper</a></li>
<li><a class="reference internal" href="#handletimefilter">HandletimeFilter</a></li>
<li><a class="reference internal" href="#defaultserver">DefaultServer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#construction">Construction</a><ul>
<li><a class="reference internal" href="#clientbuilder">ClientBuilder</a></li>
<li><a class="reference internal" href="#statsservicefactory">StatsServiceFactory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#service-discovery">Service Discovery</a><ul>
<li><a class="reference internal" href="#name-resolution">Name Resolution</a></li>
<li><a class="reference internal" href="#initial-resolution">Initial Resolution</a></li>
<li><a class="reference internal" href="#address-stabilization">Address Stabilization</a></li>
<li><a class="reference internal" href="#zookeeper-diagnostics">ZooKeeper Diagnostics</a><ul>
<li><a class="reference internal" href="#under-the-zk2-scope">Under the `zk2` scope</a></li>
<li><a class="reference internal" href="#under-the-zkclient-scope">Under the `zkclient` scope</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#load-balancing">Load Balancing</a><ul>
<li><a class="reference internal" href="#all-balancers">All Balancers</a></li>
<li><a class="reference internal" href="#apertureloadbandbalancer">ApertureLoadBandBalancer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fail-fast">Fail Fast</a><ul>
<li><a class="reference internal" href="#failfastfactory">FailFastFactory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#failure-accrual">Failure Accrual</a></li>
<li><a class="reference internal" href="#idle-apoptosis">Idle Apoptosis</a><ul>
<li><a class="reference internal" href="#expiringservice">ExpiringService</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rate-limiting">Rate Limiting</a><ul>
<li><a class="reference internal" href="#ratelimitingfilter">RateLimitingFilter</a></li>
<li><a class="reference internal" href="#requeue">Requeue</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pooling">Pooling</a><ul>
<li><a class="reference internal" href="#cachingpool">CachingPool</a></li>
<li><a class="reference internal" href="#watermarkpool">WatermarkPool</a></li>
<li><a class="reference internal" href="#singletonpool">SingletonPool</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transport">Transport</a><ul>
<li><a class="reference internal" href="#channelconnector">ChannelConnector</a></li>
<li><a class="reference internal" href="#serverbridge">ServerBridge</a></li>
<li><a class="reference internal" href="#channelrequeststatshandler">ChannelRequestStatsHandler</a></li>
<li><a class="reference internal" href="#channelstatshandler">ChannelStatsHandler</a></li>
<li><a class="reference internal" href="#idlechannelhandler">IdleChannelHandler</a></li>
<li><a class="reference internal" href="#idleconnectionfilter">IdleConnectionFilter</a></li>
<li><a class="reference internal" href="#thrift">Thrift</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requeues">Requeues</a></li>
<li><a class="reference internal" href="#mux">Mux</a></li>
<li><a class="reference internal" href="#threshold-failure-detector">Threshold Failure Detector</a><ul>
<li><a class="reference internal" href="#thresholdfailuredetector">ThresholdFailureDetector</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Extending.html" title="previous chapter">Extending Finagle</a></li>
      <li>Next: <a href="FAQ.html" title="next chapter">FAQ</a></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Search the contents of this site.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">&copy; Copyright 2014 Twitter, Inc.</div>
  
  </body>
</html>